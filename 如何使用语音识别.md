# 🎤 如何使用语音识别功能

## 🚀 快速开始

### 方法1: 使用快速启动脚本（推荐）

双击运行 `快速启动.bat`，脚本会自动：
1. 检查配置
2. 测试连接
3. 启动应用

### 方法2: 手动启动

```bash
# 1. 检查配置
python diagnose_speech.py

# 2. 测试连接
python test_speech_connection.py

# 3. 启动应用
python run.py
```

## 📱 使用步骤

1. **打开浏览器**
   - 访问：`http://localhost:8080`
   - ⚠️ 必须使用 `localhost`，不要使用 IP 地址

2. **切换到语音输入**
   - 点击页面顶部的 **"语音输入"** 标签

3. **开始录音**
   - 点击 **"开始录音"** 按钮
   - 如果浏览器弹出权限请求，点击 **"允许"**

4. **说出旅行需求**
   - 清晰地说出您的旅行计划
   - 例如："我想去北京旅游，5天，预算1万元"
   - 您会看到实时识别结果（蓝色=识别中，绿色=最终结果）

5. **停止录音**
   - 点击 **"停止录音"** 按钮

6. **生成计划**
   - 点击 **"生成旅行计划"** 按钮
   - AI 会根据您的语音输入生成详细的旅行计划

## ✅ 成功标志

### 浏览器控制台应该显示：
```
Socket connected
[语音识别] 服务器已启动: 语音识别已启动，请开始说话
[录音] 流式录音已启动 (PCM 16kHz)
[语音识别] 临时结果: 我想去...
[语音识别] 最终结果: 我想去北京旅游，5天，预算1万元
```

### 服务器控制台应该显示：
```
[OK] 语音识别服务已连接
[OK] 已发送初始化请求
[OK] 初始化成功
[语音识别] 临时结果: 我想去...
[语音识别] 最终结果: 我想去北京旅游，5天，预算1万元
```

## ⚠️ 常见问题

### 问题：麦克风无法访问

**解决方法**：
1. 检查浏览器地址栏左侧的锁图标，确保允许麦克风
2. 关闭其他占用麦克风的应用（Zoom、Teams、微信等）
3. Windows: 检查"设置 → 隐私 → 麦克风"，允许桌面应用访问

### 问题：没有识别结果

**解决方法**：
1. 确保说话声音清晰
2. 检查环境是否安静
3. 查看服务器控制台是否有错误
4. 尝试重新启动应用

### 问题：识别不准确

**建议**：
- 说话清晰，语速适中
- 减少背景噪音
- 使用优质麦克风
- 调整麦克风音量

## 🛠️ 诊断工具

如果遇到问题，运行诊断脚本：

```bash
# 检查配置
python diagnose_speech.py

# 测试连接
python test_speech_connection.py
```

## 💡 提示

- 语音识别支持中文
- 可以说出完整的旅行需求，包括目的地、天数、预算等
- 识别结果会自动填充到输入框
- 也可以在识别后手动修改文本

## 📞 需要帮助？

查看详细的修复报告：`语音识别问题修复报告.md`

---

**祝您使用愉快！** 🎉
